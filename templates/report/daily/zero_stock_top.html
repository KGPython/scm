{% load basefilter %}
<html>
<head>
    <meta charset="UTF-8">
    <title>商业供应链系统</title>
</head>
<body>
{% include 'common/nav.html' %}
<script type="text/javascript" src="{{ static }}/js/handsontable.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="{{ static }}/css/handsontable.css">
<div class="tTitle tTitle-report">
    <h1>零库存排名日报（）</h1>
</div>
<div id="tableReport">
</div>
{% include "common/footer.html" %}
<script>
    var tody = new Date();
    var yesterday = getYestodayDate(tody);
    yesterday = yesterday.getDate()

    var table = [];
    var theadRow1 = {'shopid':'门店编码','shopname':'门店名称','yxSum':'','zeroSum':'','zhonbiSum':'','mingciSum':'月累计排名（不含联营和烟2001）'};
    var theadRow2 = {'shopid':'','shopname':'','yxSum':'有效商品数','zeroSum':'零库存数','zhonbiSum':'占比','mingciSum':'名次'};
    var mergeCellsList = [
        {row: 0, col: 0, rowspan: 2, colspan: 1},
        {row: 0, col: 1, rowspan: 2, colspan: 1},
        {row: 0, col: 2, rowspan: 1, colspan: 4}
    ];

    var i=0;
    var j=1;
    var k=6;
    do{
        //第一行表头
        theadRow1['yx_'+j]=j.toString()+'日排名(不含联营和烟2001)';
        theadRow1['zero_'+j]='';
        theadRow1['zhonbi_'+j]='';
        theadRow1['mingci_'+j]= '';
        //第二行表头
        theadRow2['yx_'+j]='有效商品数';
        theadRow2['zero_'+j]='零库存数';
        theadRow2['zhonbi_'+j]='占比';
        theadRow2['mingci_'+j]= '名次';
        //单元格合并处理
        var mergeCell = {};
        mergeCell['row'] = 0;
        mergeCell['col'] = k;
        mergeCell['rowspan'] = 1;
        mergeCell['colspan'] = 4;
        mergeCellsList.push(mergeCell);

        i+=4;//每日单元格数量
        j+=1;//日期
        k+=4;//每次合并单元格数量
    }while(i<yesterday*4);
    table.push(theadRow1);
    table.push(theadRow2);

    var container = document.getElementById('tableReport');
    var hot = new Handsontable(container,{
        data: table,
        colWidths: 120,
        className: "htCenter htMiddle",
        rowHeaders: true,
        colHeaders: true,
        contextMenu: false,
        fixedRowsTop: 2,
        fixedColumnsLeft: 6,
        manualColumnResize: true,
        manualRowMove: true,
        manualColumnMove: true,
        columnSorting: true,
        sortIndicator: true,
        readOnly:true,
        mergeCells: mergeCellsList
    })
</script>
</body>
</html>